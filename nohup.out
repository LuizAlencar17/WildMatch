======================================================================
WildMatch Species Classification Pipeline
======================================================================

[1] Loading/Building Knowledge Base...
✓ Loading existing knowledge base from data/knowledge_base.json
Loading JSON file from data/knowledge_base.json
✓ Knowledge base loaded: 12 species

[2] Batch Prediction...
Running predictions on 100 images...
Using 3 captions per image for self-consistency
VLM Model: gpt-4o-mini, LLM Model: gpt-4o-mini

Predicting:   0%|          | 0/100 [00:00<?, ?it/s]Predicting:   1%|          | 1/100 [00:13<21:36, 13.09s/it]Predicting:   2%|▏         | 2/100 [00:24<19:37, 12.01s/it]Predicting:   3%|▎         | 3/100 [00:35<19:06, 11.82s/it]Predicting:   4%|▍         | 4/100 [00:45<17:40, 11.05s/it]Predicting:   5%|▌         | 5/100 [00:55<16:46, 10.59s/it]Predicting:   6%|▌         | 6/100 [01:07<17:03, 10.88s/it]Predicting:   7%|▋         | 7/100 [01:14<15:19,  9.89s/it]Predicting:   8%|▊         | 8/100 [01:31<18:37, 12.15s/it]Predicting:   9%|▉         | 9/100 [01:43<18:03, 11.90s/it]Predicting:  10%|█         | 10/100 [01:51<16:16, 10.85s/it]Predicting:  11%|█         | 11/100 [02:02<15:51, 10.70s/it]Predicting:  12%|█▏        | 12/100 [02:18<18:09, 12.38s/it]Predicting:  13%|█▎        | 13/100 [02:37<21:08, 14.58s/it]Predicting:  14%|█▍        | 14/100 [02:47<18:48, 13.13s/it]Predicting:  15%|█▌        | 15/100 [03:00<18:33, 13.10s/it]Predicting:  16%|█▌        | 16/100 [03:14<18:25, 13.16s/it]Predicting:  17%|█▋        | 17/100 [03:26<17:43, 12.81s/it]Predicting:  18%|█▊        | 18/100 [03:37<17:01, 12.45s/it]Predicting:  19%|█▉        | 19/100 [03:46<15:31, 11.49s/it]Predicting:  20%|██        | 20/100 [04:02<16:59, 12.75s/it]Predicting:  21%|██        | 21/100 [04:14<16:33, 12.57s/it]Predicting:  22%|██▏       | 22/100 [04:27<16:21, 12.59s/it]Predicting:  23%|██▎       | 23/100 [04:41<16:51, 13.13s/it]Predicting:  24%|██▍       | 24/100 [04:58<17:53, 14.13s/it]Predicting:  25%|██▌       | 25/100 [05:11<17:23, 13.92s/it]Predicting:  26%|██▌       | 26/100 [05:28<18:09, 14.72s/it]Predicting:  27%|██▋       | 27/100 [05:44<18:36, 15.29s/it]Predicting:  28%|██▊       | 28/100 [05:57<17:28, 14.56s/it]Predicting:  29%|██▉       | 29/100 [06:13<17:45, 15.00s/it]Predicting:  30%|███       | 30/100 [06:25<16:23, 14.05s/it]Predicting:  31%|███       | 31/100 [06:40<16:24, 14.26s/it]Predicting:  32%|███▏      | 32/100 [06:48<14:04, 12.42s/it]Predicting:  33%|███▎      | 33/100 [07:01<14:07, 12.66s/it]Predicting:  34%|███▍      | 34/100 [07:11<13:04, 11.89s/it]Predicting:  35%|███▌      | 35/100 [07:28<14:26, 13.33s/it]Predicting:  36%|███▌      | 36/100 [07:39<13:35, 12.75s/it]Predicting:  37%|███▋      | 37/100 [07:49<12:19, 11.73s/it]Predicting:  38%|███▊      | 38/100 [08:00<12:02, 11.66s/it]Predicting:  39%|███▉      | 39/100 [08:09<11:02, 10.86s/it]Predicting:  40%|████      | 40/100 [08:25<12:15, 12.26s/it]Predicting:  41%|████      | 41/100 [08:40<13:04, 13.29s/it]Predicting:  42%|████▏     | 42/100 [08:52<12:18, 12.73s/it]Predicting:  43%|████▎     | 43/100 [09:05<12:12, 12.85s/it]Predicting:  44%|████▍     | 44/100 [09:19<12:24, 13.29s/it]Predicting:  45%|████▌     | 45/100 [09:33<12:14, 13.35s/it]Predicting:  46%|████▌     | 46/100 [09:51<13:12, 14.68s/it]Predicting:  47%|████▋     | 47/100 [10:04<12:38, 14.31s/it]Predicting:  48%|████▊     | 48/100 [10:15<11:38, 13.44s/it]Predicting:  49%|████▉     | 49/100 [10:28<11:05, 13.04s/it]Predicting:  50%|█████     | 50/100 [10:43<11:30, 13.81s/it]Predicting:  51%|█████     | 51/100 [10:56<11:00, 13.48s/it]Predicting:  52%|█████▏    | 52/100 [11:09<10:48, 13.52s/it]Predicting:  53%|█████▎    | 53/100 [11:23<10:31, 13.43s/it]Predicting:  54%|█████▍    | 54/100 [11:37<10:29, 13.69s/it]Predicting:  55%|█████▌    | 55/100 [11:53<10:47, 14.39s/it]Predicting:  56%|█████▌    | 56/100 [12:11<11:27, 15.62s/it]Predicting:  57%|█████▋    | 57/100 [12:31<11:56, 16.65s/it]Predicting:  58%|█████▊    | 58/100 [12:42<10:33, 15.07s/it]Predicting:  59%|█████▉    | 59/100 [12:51<09:06, 13.33s/it]Predicting:  60%|██████    | 60/100 [13:04<08:47, 13.18s/it]Predicting:  61%|██████    | 61/100 [13:19<08:50, 13.60s/it]Predicting:  62%|██████▏   | 62/100 [13:36<09:22, 14.80s/it]Predicting:  63%|██████▎   | 63/100 [13:55<09:54, 16.08s/it]Predicting:  64%|██████▍   | 64/100 [14:14<10:08, 16.89s/it]Predicting:  65%|██████▌   | 65/100 [14:26<09:04, 15.55s/it]Predicting:  66%|██████▌   | 66/100 [14:39<08:21, 14.74s/it]Predicting:  67%|██████▋   | 67/100 [14:51<07:35, 13.81s/it]Predicting:  68%|██████▊   | 68/100 [15:05<07:21, 13.80s/it]Predicting:  69%|██████▉   | 69/100 [15:27<08:28, 16.39s/it]Predicting:  70%|███████   | 70/100 [15:38<07:21, 14.72s/it]Predicting:  71%|███████   | 71/100 [15:58<07:53, 16.34s/it]Predicting:  72%|███████▏  | 72/100 [16:14<07:30, 16.10s/it]Predicting:  73%|███████▎  | 73/100 [16:23<06:19, 14.06s/it]Predicting:  74%|███████▍  | 74/100 [16:32<05:30, 12.71s/it]Predicting:  75%|███████▌  | 75/100 [16:46<05:24, 12.98s/it]Predicting:  76%|███████▌  | 76/100 [17:02<05:29, 13.74s/it]Predicting:  77%|███████▋  | 77/100 [17:16<05:18, 13.83s/it]Predicting:  78%|███████▊  | 78/100 [17:28<04:51, 13.27s/it]Predicting:  79%|███████▉  | 79/100 [17:45<05:02, 14.43s/it]Predicting:  80%|████████  | 80/100 [18:00<04:52, 14.61s/it]Predicting:  81%|████████  | 81/100 [18:14<04:33, 14.37s/it]Predicting:  82%|████████▏ | 82/100 [18:30<04:27, 14.88s/it]Predicting:  83%|████████▎ | 83/100 [18:45<04:14, 14.95s/it]Predicting:  84%|████████▍ | 84/100 [19:07<04:35, 17.21s/it]Predicting:  85%|████████▌ | 85/100 [19:24<04:16, 17.09s/it]Predicting:  86%|████████▌ | 86/100 [19:39<03:49, 16.38s/it]Predicting:  87%|████████▋ | 87/100 [19:50<03:11, 14.75s/it]Predicting:  88%|████████▊ | 88/100 [20:00<02:40, 13.36s/it]Predicting:  89%|████████▉ | 89/100 [20:15<02:32, 13.89s/it]Predicting:  90%|█████████ | 90/100 [20:26<02:08, 12.89s/it]Predicting:  91%|█████████ | 91/100 [20:35<01:45, 11.75s/it]Predicting:  92%|█████████▏| 92/100 [20:45<01:30, 11.27s/it]Predicting:  93%|█████████▎| 93/100 [20:57<01:20, 11.45s/it]Predicting:  94%|█████████▍| 94/100 [21:14<01:18, 13.12s/it]Predicting:  95%|█████████▌| 95/100 [21:30<01:10, 14.04s/it]Predicting:  96%|█████████▌| 96/100 [21:44<00:56, 14.22s/it]Predicting:  97%|█████████▋| 97/100 [22:06<00:49, 16.35s/it]Predicting:  98%|█████████▊| 98/100 [22:20<00:31, 15.71s/it]Predicting:  99%|█████████▉| 99/100 [22:31<00:14, 14.41s/it]Predicting: 100%|██████████| 100/100 [22:42<00:00, 13.14s/it]Predicting: 100%|██████████| 100/100 [22:42<00:00, 13.62s/it]

✓ Progress saved (440/100 images)
⚠ Warning: LLM returned 'None' which is not in species list
⚠ Warning: LLM returned 'None' which is not in species list
⚠ Warning: LLM returned 'None' which is not in species list

✓ Progress saved (50/100 images)

✓ Progress saved (850/100 images)
⚠ Warning: LLM returned 'None' which is not in species list

✓ Progress saved (610/100 images)

✓ Progress saved (110/100 images)
⚠ Warning: LLM returned 'None' which is not in species list
⚠ Warning: LLM returned 'None' which is not in species list

✓ Progress saved (310/100 images)

✓ Progress saved (550/100 images)

✓ Progress saved (910/100 images)

✓ Predictions complete!
✓ Saved to: results/predictions.csv
✓ Overall Accuracy: 71.00%

✓ Batch prediction complete!
Results saved to: results/predictions.csv

======================================================================
Pipeline execution complete!
======================================================================
======================================================================
Structured WildMatch Species Classification Pipeline
======================================================================

[1] Loading/Building Structured Knowledge Base...
✓ Loading existing structured knowledge base from data/structured_knowledge_base.json
Loading JSON file from data/structured_knowledge_base.json
✓ Structured knowledge base loaded: 12 species

[2] Batch Prediction...
Running predictions on 100 images...
Using 3 captions per image for self-consistency
VLM Model: gpt-4o-mini, LLM Model: gpt-4o-mini

Predicting:   0%|          | 0/100 [00:00<?, ?it/s]Predicting:   1%|          | 1/100 [00:14<24:09, 14.64s/it]Predicting:   2%|▏         | 2/100 [00:25<20:32, 12.58s/it]Predicting:   3%|▎         | 3/100 [00:37<19:32, 12.08s/it]Predicting:   4%|▍         | 4/100 [00:48<18:32, 11.58s/it]Predicting:   5%|▌         | 5/100 [01:01<19:26, 12.28s/it]Predicting:   6%|▌         | 6/100 [01:13<19:13, 12.27s/it]Predicting:   7%|▋         | 7/100 [01:26<19:11, 12.38s/it]Predicting:   8%|▊         | 8/100 [01:37<18:34, 12.11s/it]Predicting:   9%|▉         | 9/100 [01:50<18:25, 12.15s/it]Predicting:  10%|█         | 10/100 [02:00<17:20, 11.56s/it]Predicting:  11%|█         | 11/100 [02:12<17:33, 11.83s/it]Predicting:  12%|█▏        | 12/100 [02:23<16:47, 11.45s/it]Predicting:  13%|█▎        | 13/100 [02:35<16:42, 11.52s/it]Predicting:  14%|█▍        | 14/100 [02:45<16:01, 11.18s/it]Predicting:  15%|█▌        | 15/100 [02:58<16:29, 11.64s/it]Predicting:  16%|█▌        | 16/100 [03:10<16:29, 11.78s/it]Predicting:  17%|█▋        | 17/100 [03:23<16:53, 12.21s/it]Predicting:  18%|█▊        | 18/100 [03:34<16:10, 11.84s/it]Predicting:  19%|█▉        | 19/100 [03:47<16:18, 12.09s/it]Predicting:  20%|██        | 20/100 [03:58<15:41, 11.77s/it]Predicting:  21%|██        | 21/100 [04:09<15:14, 11.58s/it]Predicting:  22%|██▏       | 22/100 [04:21<15:15, 11.74s/it]Predicting:  23%|██▎       | 23/100 [04:32<14:48, 11.54s/it]Predicting:  24%|██▍       | 24/100 [04:44<14:52, 11.75s/it]Predicting:  25%|██▌       | 25/100 [04:56<14:29, 11.59s/it]Predicting:  26%|██▌       | 26/100 [05:07<14:13, 11.53s/it]Predicting:  27%|██▋       | 27/100 [05:17<13:40, 11.24s/it]Predicting:  28%|██▊       | 28/100 [05:31<14:15, 11.89s/it]Predicting:  29%|██▉       | 29/100 [05:42<13:39, 11.54s/it]Predicting:  30%|███       | 30/100 [05:53<13:24, 11.49s/it]Predicting:  31%|███       | 31/100 [06:03<12:43, 11.06s/it]Predicting:  32%|███▏      | 32/100 [06:13<12:18, 10.86s/it]Predicting:  33%|███▎      | 33/100 [06:25<12:14, 10.96s/it]Predicting:  34%|███▍      | 34/100 [06:35<11:44, 10.67s/it]Predicting:  35%|███▌      | 35/100 [06:47<12:02, 11.12s/it]Predicting:  36%|███▌      | 36/100 [07:00<12:26, 11.67s/it]Predicting:  37%|███▋      | 37/100 [07:11<12:07, 11.55s/it]Predicting:  38%|███▊      | 38/100 [07:22<11:49, 11.44s/it]Predicting:  39%|███▉      | 39/100 [07:34<11:36, 11.41s/it]Predicting:  40%|████      | 40/100 [07:45<11:26, 11.44s/it]Predicting:  41%|████      | 41/100 [07:57<11:20, 11.53s/it]Predicting:  42%|████▏     | 42/100 [08:08<11:10, 11.56s/it]Predicting:  43%|████▎     | 43/100 [08:20<11:02, 11.63s/it]Predicting:  44%|████▍     | 44/100 [08:31<10:32, 11.29s/it]Predicting:  45%|████▌     | 45/100 [08:41<09:58, 10.88s/it]Predicting:  46%|████▌     | 46/100 [08:53<10:04, 11.20s/it]Predicting:  47%|████▋     | 47/100 [09:05<10:05, 11.42s/it]Predicting:  48%|████▊     | 48/100 [09:14<09:24, 10.86s/it]Predicting:  49%|████▉     | 49/100 [09:27<09:45, 11.48s/it]Predicting:  50%|█████     | 50/100 [09:37<09:14, 11.08s/it]Predicting:  51%|█████     | 51/100 [09:47<08:51, 10.85s/it]Predicting:  52%|█████▏    | 52/100 [09:59<08:54, 11.14s/it]Predicting:  53%|█████▎    | 53/100 [10:13<09:13, 11.78s/it]Predicting:  54%|█████▍    | 54/100 [10:22<08:36, 11.22s/it]Predicting:  55%|█████▌    | 55/100 [10:33<08:09, 10.88s/it]Predicting:  56%|█████▌    | 56/100 [10:42<07:34, 10.33s/it]Predicting:  57%|█████▋    | 57/100 [10:54<07:45, 10.83s/it]Predicting:  58%|█████▊    | 58/100 [11:03<07:22, 10.54s/it]Predicting:  59%|█████▉    | 59/100 [11:14<07:11, 10.54s/it]Predicting:  60%|██████    | 60/100 [11:24<06:55, 10.39s/it]Predicting:  61%|██████    | 61/100 [11:35<06:56, 10.67s/it]Predicting:  62%|██████▏   | 62/100 [11:47<07:01, 11.10s/it]Predicting:  63%|██████▎   | 63/100 [11:59<06:54, 11.20s/it]Predicting:  64%|██████▍   | 64/100 [12:09<06:27, 10.77s/it]Predicting:  65%|██████▌   | 65/100 [12:20<06:23, 10.96s/it]Predicting:  66%|██████▌   | 66/100 [12:31<06:08, 10.83s/it]Predicting:  67%|██████▋   | 67/100 [12:42<06:06, 11.10s/it]Predicting:  68%|██████▊   | 68/100 [12:52<05:38, 10.58s/it]Predicting:  69%|██████▉   | 69/100 [13:01<05:16, 10.21s/it]Predicting:  70%|███████   | 70/100 [13:12<05:11, 10.40s/it]Predicting:  71%|███████   | 71/100 [13:24<05:13, 10.81s/it]Predicting:  72%|███████▏  | 72/100 [13:35<05:09, 11.07s/it]Predicting:  73%|███████▎  | 73/100 [13:44<04:41, 10.42s/it]Predicting:  74%|███████▍  | 74/100 [14:00<05:15, 12.12s/it]Predicting:  75%|███████▌  | 75/100 [14:11<04:54, 11.76s/it]Predicting:  76%|███████▌  | 76/100 [14:21<04:28, 11.18s/it]Predicting:  77%|███████▋  | 77/100 [14:31<04:09, 10.85s/it]Predicting:  78%|███████▊  | 78/100 [14:44<04:09, 11.35s/it]Predicting:  79%|███████▉  | 79/100 [14:53<03:44, 10.71s/it]Predicting:  80%|████████  | 80/100 [15:03<03:33, 10.68s/it]Predicting:  81%|████████  | 81/100 [15:15<03:27, 10.90s/it]Predicting:  82%|████████▏ | 82/100 [15:26<03:15, 10.83s/it]Predicting:  83%|████████▎ | 83/100 [15:37<03:06, 10.98s/it]Predicting:  84%|████████▍ | 84/100 [15:48<02:56, 11.04s/it]Predicting:  85%|████████▌ | 85/100 [15:58<02:40, 10.67s/it]Predicting:  86%|████████▌ | 86/100 [16:13<02:47, 11.99s/it]Predicting:  87%|████████▋ | 87/100 [16:25<02:35, 11.96s/it]Predicting:  88%|████████▊ | 88/100 [16:37<02:22, 11.92s/it]Predicting:  89%|████████▉ | 89/100 [16:48<02:10, 11.86s/it]Predicting:  90%|█████████ | 90/100 [17:00<01:59, 11.93s/it]Predicting:  91%|█████████ | 91/100 [17:13<01:47, 11.99s/it]Predicting:  92%|█████████▏| 92/100 [17:24<01:35, 11.94s/it]Predicting:  93%|█████████▎| 93/100 [17:46<01:42, 14.71s/it]Predicting:  94%|█████████▍| 94/100 [17:59<01:26, 14.34s/it]Predicting:  95%|█████████▌| 95/100 [18:11<01:08, 13.73s/it]Predicting:  96%|█████████▌| 96/100 [18:23<00:51, 12.95s/it]Predicting:  97%|█████████▋| 97/100 [18:33<00:36, 12.31s/it]Predicting:  98%|█████████▊| 98/100 [18:47<00:25, 12.63s/it]Predicting:  99%|█████████▉| 99/100 [19:00<00:12, 12.71s/it]Predicting: 100%|██████████| 100/100 [19:13<00:00, 12.80s/it]Predicting: 100%|██████████| 100/100 [19:13<00:00, 11.53s/it]

✓ Progress saved (440/100 images)

✓ Progress saved (50/100 images)

✓ Progress saved (850/100 images)

✓ Progress saved (610/100 images)

✓ Progress saved (110/100 images)

✓ Progress saved (310/100 images)

✓ Progress saved (550/100 images)

✓ Progress saved (910/100 images)

✓ Predictions complete!
✓ Saved to: results/structured_predictions.csv
✓ Overall Accuracy: 55.00%

✓ Batch prediction complete!
Results saved to: results/structured_predictions.csv

======================================================================
Pipeline execution complete!
======================================================================
